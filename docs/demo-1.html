<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Demo | Meta-Workflow</title>
  <meta name="description" content="This is a workflow for metabolomics studies." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Demo | Meta-Workflow" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="This is a workflow for metabolomics studies." />
  <meta name="github-repo" content="yufree/metaworkflow" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Demo | Meta-Workflow" />
  
  <meta name="twitter:description" content="This is a workflow for metabolomics studies." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Miao YU" />


<meta name="date" content="2020-06-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="workflow-2.html"/>
<link rel="next" href="exposome.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Metabolomics Workflow</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#history"><i class="fa fa-check"></i><b>1.1</b> History</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#history-of-mass-spectrometry"><i class="fa fa-check"></i><b>1.1.1</b> History of Mass Spectrometry</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#history-of-metabolomcis"><i class="fa fa-check"></i><b>1.1.2</b> History of Metabolomcis</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#defination"><i class="fa fa-check"></i><b>1.1.3</b> Defination</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#reviews-and-tutorials"><i class="fa fa-check"></i><b>1.2</b> Reviews and tutorials</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#workflow"><i class="fa fa-check"></i><b>1.2.1</b> Workflow</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#data-analysis"><i class="fa fa-check"></i><b>1.2.2</b> Data analysis</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#application"><i class="fa fa-check"></i><b>1.2.3</b> Application</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction.html"><a href="introduction.html#challenge"><i class="fa fa-check"></i><b>1.2.4</b> Challenge</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#trends-in-metabolomics"><i class="fa fa-check"></i><b>1.3</b> Trends in Metabolomics</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#workflow-1"><i class="fa fa-check"></i><b>1.4</b> Workflow</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="experimental-designdoe.html"><a href="experimental-designdoe.html"><i class="fa fa-check"></i><b>2</b> Experimental design(DoE)</a><ul>
<li class="chapter" data-level="2.1" data-path="experimental-designdoe.html"><a href="experimental-designdoe.html#homogeneity-study"><i class="fa fa-check"></i><b>2.1</b> Homogeneity study</a></li>
<li class="chapter" data-level="2.2" data-path="experimental-designdoe.html"><a href="experimental-designdoe.html#heterogeneity-study"><i class="fa fa-check"></i><b>2.2</b> Heterogeneity study</a></li>
<li class="chapter" data-level="2.3" data-path="experimental-designdoe.html"><a href="experimental-designdoe.html#sample-size"><i class="fa fa-check"></i><b>2.3</b> Sample size</a></li>
<li class="chapter" data-level="2.4" data-path="experimental-designdoe.html"><a href="experimental-designdoe.html#software"><i class="fa fa-check"></i><b>2.4</b> Software</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pretreatment.html"><a href="pretreatment.html"><i class="fa fa-check"></i><b>3</b> Pretreatment</a><ul>
<li class="chapter" data-level="3.1" data-path="pretreatment.html"><a href="pretreatment.html#quenching"><i class="fa fa-check"></i><b>3.1</b> Quenching</a></li>
<li class="chapter" data-level="3.2" data-path="pretreatment.html"><a href="pretreatment.html#extraction"><i class="fa fa-check"></i><b>3.2</b> Extraction</a></li>
<li class="chapter" data-level="3.3" data-path="pretreatment.html"><a href="pretreatment.html#derivatization"><i class="fa fa-check"></i><b>3.3</b> Derivatization</a></li>
<li class="chapter" data-level="3.4" data-path="pretreatment.html"><a href="pretreatment.html#storage"><i class="fa fa-check"></i><b>3.4</b> Storage</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="instrumental-analysis.html"><a href="instrumental-analysis.html"><i class="fa fa-check"></i><b>4</b> Instrumental analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="instrumental-analysis.html"><a href="instrumental-analysis.html#column-and-gradient-selection"><i class="fa fa-check"></i><b>4.1</b> Column and gradient selection</a></li>
<li class="chapter" data-level="4.2" data-path="instrumental-analysis.html"><a href="instrumental-analysis.html#pooled-qc-samples"><i class="fa fa-check"></i><b>4.2</b> Pooled QC samples</a></li>
<li class="chapter" data-level="4.3" data-path="instrumental-analysis.html"><a href="instrumental-analysis.html#mass-resolution"><i class="fa fa-check"></i><b>4.3</b> Mass resolution</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html"><i class="fa fa-check"></i><b>5</b> Raw data pretreatment</a><ul>
<li class="chapter" data-level="5.1" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#data-visualization"><i class="fa fa-check"></i><b>5.1</b> Data visualization</a></li>
<li class="chapter" data-level="5.2" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#peak-extraction"><i class="fa fa-check"></i><b>5.2</b> Peak extraction</a></li>
<li class="chapter" data-level="5.3" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#retention-time-correction"><i class="fa fa-check"></i><b>5.3</b> Retention Time Correction</a></li>
<li class="chapter" data-level="5.4" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#filling-missing-values"><i class="fa fa-check"></i><b>5.4</b> Filling missing values</a></li>
<li class="chapter" data-level="5.5" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#spectral-deconvolution"><i class="fa fa-check"></i><b>5.5</b> Spectral deconvolution</a></li>
<li class="chapter" data-level="5.6" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#dynamic-range"><i class="fa fa-check"></i><b>5.6</b> Dynamic Range</a><ul>
<li class="chapter" data-level="5.6.1" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#non-detects"><i class="fa fa-check"></i><b>5.6.1</b> Non-detects</a></li>
<li class="chapter" data-level="5.6.2" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#over-detection-limit"><i class="fa fa-check"></i><b>5.6.2</b> Over Detection Limit</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#rsdfold-change-filter"><i class="fa fa-check"></i><b>5.7</b> RSD/fold change Filter</a></li>
<li class="chapter" data-level="5.8" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#power-analysis-filter"><i class="fa fa-check"></i><b>5.8</b> Power Analysis Filter</a></li>
<li class="chapter" data-level="5.9" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#software-1"><i class="fa fa-check"></i><b>5.9</b> Software</a><ul>
<li class="chapter" data-level="5.9.1" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#peak-picking"><i class="fa fa-check"></i><b>5.9.1</b> Peak picking</a></li>
<li class="chapter" data-level="5.9.2" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#for-msms"><i class="fa fa-check"></i><b>5.9.2</b> For MS/MS</a></li>
<li class="chapter" data-level="5.9.3" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#improved-peak-picking"><i class="fa fa-check"></i><b>5.9.3</b> Improved Peak picking</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="raw-data-pretreatment.html"><a href="raw-data-pretreatment.html#tips"><i class="fa fa-check"></i><b>5.10</b> Tips</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="peaks-normalization.html"><a href="peaks-normalization.html"><i class="fa fa-check"></i><b>6</b> Peaks normalization</a><ul>
<li class="chapter" data-level="6.1" data-path="peaks-normalization.html"><a href="peaks-normalization.html#batch-effects-classification"><i class="fa fa-check"></i><b>6.1</b> Batch effects classification</a></li>
<li class="chapter" data-level="6.2" data-path="peaks-normalization.html"><a href="peaks-normalization.html#batch-effects-visulization"><i class="fa fa-check"></i><b>6.2</b> Batch effects visulization</a></li>
<li class="chapter" data-level="6.3" data-path="peaks-normalization.html"><a href="peaks-normalization.html#source-of-batch-effects"><i class="fa fa-check"></i><b>6.3</b> Source of batch effects</a></li>
<li class="chapter" data-level="6.4" data-path="peaks-normalization.html"><a href="peaks-normalization.html#avoid-batch-effects-by-doe"><i class="fa fa-check"></i><b>6.4</b> Avoid batch effects by DoE</a></li>
<li class="chapter" data-level="6.5" data-path="peaks-normalization.html"><a href="peaks-normalization.html#post-hoc-data-normalization"><i class="fa fa-check"></i><b>6.5</b> post hoc data normalization</a><ul>
<li class="chapter" data-level="6.5.1" data-path="peaks-normalization.html"><a href="peaks-normalization.html#unsupervised-methods"><i class="fa fa-check"></i><b>6.5.1</b> Unsupervised methods</a></li>
<li class="chapter" data-level="6.5.2" data-path="peaks-normalization.html"><a href="peaks-normalization.html#supervised-methods"><i class="fa fa-check"></i><b>6.5.2</b> Supervised methods</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="peaks-normalization.html"><a href="peaks-normalization.html#method-to-validate-the-normalization"><i class="fa fa-check"></i><b>6.6</b> Method to validate the normalization</a></li>
<li class="chapter" data-level="6.7" data-path="peaks-normalization.html"><a href="peaks-normalization.html#software-2"><i class="fa fa-check"></i><b>6.7</b> Software</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="annotation.html"><a href="annotation.html"><i class="fa fa-check"></i><b>7</b> Annotation</a><ul>
<li class="chapter" data-level="7.1" data-path="annotation.html"><a href="annotation.html#issues-in-annotation"><i class="fa fa-check"></i><b>7.1</b> Issues in annotation</a></li>
<li class="chapter" data-level="7.2" data-path="annotation.html"><a href="annotation.html#peak-misidentification"><i class="fa fa-check"></i><b>7.2</b> Peak misidentification</a></li>
<li class="chapter" data-level="7.3" data-path="annotation.html"><a href="annotation.html#annotation-v.s.-identification"><i class="fa fa-check"></i><b>7.3</b> Annotation v.s. identification</a></li>
<li class="chapter" data-level="7.4" data-path="annotation.html"><a href="annotation.html#cheminformatics"><i class="fa fa-check"></i><b>7.4</b> Cheminformatics</a></li>
<li class="chapter" data-level="7.5" data-path="annotation.html"><a href="annotation.html#ms-database-for-annotation"><i class="fa fa-check"></i><b>7.5</b> MS Database for annotation</a><ul>
<li class="chapter" data-level="7.5.1" data-path="annotation.html"><a href="annotation.html#msms"><i class="fa fa-check"></i><b>7.5.1</b> MS/MS</a></li>
<li class="chapter" data-level="7.5.2" data-path="annotation.html"><a href="annotation.html#ms"><i class="fa fa-check"></i><b>7.5.2</b> MS</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="annotation.html"><a href="annotation.html#compounds-database"><i class="fa fa-check"></i><b>7.6</b> Compounds Database</a></li>
<li class="chapter" data-level="7.7" data-path="annotation.html"><a href="annotation.html#software-3"><i class="fa fa-check"></i><b>7.7</b> Software</a><ul>
<li class="chapter" data-level="7.7.1" data-path="annotation.html"><a href="annotation.html#adducts-list"><i class="fa fa-check"></i><b>7.7.1</b> Adducts list</a></li>
<li class="chapter" data-level="7.7.2" data-path="annotation.html"><a href="annotation.html#molgen"><i class="fa fa-check"></i><b>7.7.2</b> Molgen</a></li>
<li class="chapter" data-level="7.7.3" data-path="annotation.html"><a href="annotation.html#isotope"><i class="fa fa-check"></i><b>7.7.3</b> Isotope</a></li>
<li class="chapter" data-level="7.7.4" data-path="annotation.html"><a href="annotation.html#mffinder"><i class="fa fa-check"></i><b>7.7.4</b> mfFinder</a></li>
<li class="chapter" data-level="7.7.5" data-path="annotation.html"><a href="annotation.html#camera"><i class="fa fa-check"></i><b>7.7.5</b> CAMERA</a></li>
<li class="chapter" data-level="7.7.6" data-path="annotation.html"><a href="annotation.html#ramclustr"><i class="fa fa-check"></i><b>7.7.6</b> RAMClustR</a></li>
<li class="chapter" data-level="7.7.7" data-path="annotation.html"><a href="annotation.html#pmd"><i class="fa fa-check"></i><b>7.7.7</b> pmd</a></li>
<li class="chapter" data-level="7.7.8" data-path="annotation.html"><a href="annotation.html#nontarget"><i class="fa fa-check"></i><b>7.7.8</b> nontarget</a></li>
<li class="chapter" data-level="7.7.9" data-path="annotation.html"><a href="annotation.html#xmsannotator"><i class="fa fa-check"></i><b>7.7.9</b> xMSannotator</a></li>
<li class="chapter" data-level="7.7.10" data-path="annotation.html"><a href="annotation.html#cfm-id"><i class="fa fa-check"></i><b>7.7.10</b> CFM-ID</a></li>
<li class="chapter" data-level="7.7.11" data-path="annotation.html"><a href="annotation.html#mine"><i class="fa fa-check"></i><b>7.7.11</b> MINE</a></li>
<li class="chapter" data-level="7.7.12" data-path="annotation.html"><a href="annotation.html#interpretmsspectrum"><i class="fa fa-check"></i><b>7.7.12</b> InterpretMSSpectrum</a></li>
<li class="chapter" data-level="7.7.13" data-path="annotation.html"><a href="annotation.html#for-ident"><i class="fa fa-check"></i><b>7.7.13</b> For Ident</a></li>
<li class="chapter" data-level="7.7.14" data-path="annotation.html"><a href="annotation.html#retip"><i class="fa fa-check"></i><b>7.7.14</b> Retip</a></li>
<li class="chapter" data-level="7.7.15" data-path="annotation.html"><a href="annotation.html#binner"><i class="fa fa-check"></i><b>7.7.15</b> Binner</a></li>
<li class="chapter" data-level="7.7.16" data-path="annotation.html"><a href="annotation.html#mzmatch"><i class="fa fa-check"></i><b>7.7.16</b> mzmatch</a></li>
<li class="chapter" data-level="7.7.17" data-path="annotation.html"><a href="annotation.html#mz.unity"><i class="fa fa-check"></i><b>7.7.17</b> mz.unity</a></li>
<li class="chapter" data-level="7.7.18" data-path="annotation.html"><a href="annotation.html#mait"><i class="fa fa-check"></i><b>7.7.18</b> MAIT</a></li>
<li class="chapter" data-level="7.7.19" data-path="annotation.html"><a href="annotation.html#probmetab"><i class="fa fa-check"></i><b>7.7.19</b> ProbMetab</a></li>
<li class="chapter" data-level="7.7.20" data-path="annotation.html"><a href="annotation.html#ramsi"><i class="fa fa-check"></i><b>7.7.20</b> RAMSI</a></li>
<li class="chapter" data-level="7.7.21" data-path="annotation.html"><a href="annotation.html#sirius"><i class="fa fa-check"></i><b>7.7.21</b> Sirius</a></li>
<li class="chapter" data-level="7.7.22" data-path="annotation.html"><a href="annotation.html#mi-pack"><i class="fa fa-check"></i><b>7.7.22</b> MI-Pack</a></li>
<li class="chapter" data-level="7.7.23" data-path="annotation.html"><a href="annotation.html#plantmat"><i class="fa fa-check"></i><b>7.7.23</b> Plantmat</a></li>
<li class="chapter" data-level="7.7.24" data-path="annotation.html"><a href="annotation.html#metfamily"><i class="fa fa-check"></i><b>7.7.24</b> MetFamily</a></li>
<li class="chapter" data-level="7.7.25" data-path="annotation.html"><a href="annotation.html#lipidmatch"><i class="fa fa-check"></i><b>7.7.25</b> Lipidmatch</a></li>
<li class="chapter" data-level="7.7.26" data-path="annotation.html"><a href="annotation.html#molfind"><i class="fa fa-check"></i><b>7.7.26</b> MolFind</a></li>
<li class="chapter" data-level="7.7.27" data-path="annotation.html"><a href="annotation.html#metfusion"><i class="fa fa-check"></i><b>7.7.27</b> MetFusion</a></li>
<li class="chapter" data-level="7.7.28" data-path="annotation.html"><a href="annotation.html#imet"><i class="fa fa-check"></i><b>7.7.28</b> iMet</a></li>
<li class="chapter" data-level="7.7.29" data-path="annotation.html"><a href="annotation.html#metscape"><i class="fa fa-check"></i><b>7.7.29</b> Metscape</a></li>
<li class="chapter" data-level="7.7.30" data-path="annotation.html"><a href="annotation.html#metfrag"><i class="fa fa-check"></i><b>7.7.30</b> MetFrag</a></li>
<li class="chapter" data-level="7.7.31" data-path="annotation.html"><a href="annotation.html#lipidfrag"><i class="fa fa-check"></i><b>7.7.31</b> LipidFrag</a></li>
<li class="chapter" data-level="7.7.32" data-path="annotation.html"><a href="annotation.html#mycompoundid"><i class="fa fa-check"></i><b>7.7.32</b> MycompoundID</a></li>
<li class="chapter" data-level="7.7.33" data-path="annotation.html"><a href="annotation.html#magma"><i class="fa fa-check"></i><b>7.7.33</b> magma</a></li>
<li class="chapter" data-level="7.7.34" data-path="annotation.html"><a href="annotation.html#metexpert"><i class="fa fa-check"></i><b>7.7.34</b> MetExpert</a></li>
<li class="chapter" data-level="7.7.35" data-path="annotation.html"><a href="annotation.html#ms-dia"><i class="fa fa-check"></i><b>7.7.35</b> MS-DIA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="omics-analysis.html"><a href="omics-analysis.html"><i class="fa fa-check"></i><b>8</b> Omics analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="omics-analysis.html"><a href="omics-analysis.html#from-bottom-up-to-top-down"><i class="fa fa-check"></i><b>8.1</b> From Bottom-up to Top-down</a></li>
<li class="chapter" data-level="8.2" data-path="omics-analysis.html"><a href="omics-analysis.html#pathway-analysis"><i class="fa fa-check"></i><b>8.2</b> Pathway analysis</a><ul>
<li class="chapter" data-level="8.2.1" data-path="omics-analysis.html"><a href="omics-analysis.html#pathway-database"><i class="fa fa-check"></i><b>8.2.1</b> Pathway Database</a></li>
<li class="chapter" data-level="8.2.2" data-path="omics-analysis.html"><a href="omics-analysis.html#pathway-software"><i class="fa fa-check"></i><b>8.2.2</b> Pathway software</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="omics-analysis.html"><a href="omics-analysis.html#network-analysis"><i class="fa fa-check"></i><b>8.3</b> Network analysis</a></li>
<li class="chapter" data-level="8.4" data-path="omics-analysis.html"><a href="omics-analysis.html#omics-integration"><i class="fa fa-check"></i><b>8.4</b> Omics integration</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html"><i class="fa fa-check"></i><b>9</b> Common analysis methods for metabolomics</a><ul>
<li class="chapter" data-level="9.1" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html#basic-statistical-analysis"><i class="fa fa-check"></i><b>9.1</b> Basic Statistical Analysis</a></li>
<li class="chapter" data-level="9.2" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html#differences-analysis"><i class="fa fa-check"></i><b>9.2</b> Differences analysis</a><ul>
<li class="chapter" data-level="9.2.1" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html#t-test-or-anova"><i class="fa fa-check"></i><b>9.2.1</b> T-test or ANOVA</a></li>
<li class="chapter" data-level="9.2.2" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html#limma"><i class="fa fa-check"></i><b>9.2.2</b> LIMMA</a></li>
<li class="chapter" data-level="9.2.3" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html#bayesian-mixture-model"><i class="fa fa-check"></i><b>9.2.3</b> Bayesian mixture model</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html#pca"><i class="fa fa-check"></i><b>9.3</b> PCA</a></li>
<li class="chapter" data-level="9.4" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html#cluster-analysis"><i class="fa fa-check"></i><b>9.4</b> Cluster Analysis</a></li>
<li class="chapter" data-level="9.5" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html#plsda"><i class="fa fa-check"></i><b>9.5</b> PLSDA</a></li>
<li class="chapter" data-level="9.6" data-path="common-analysis-methods-for-metabolomics.html"><a href="common-analysis-methods-for-metabolomics.html#software-4"><i class="fa fa-check"></i><b>9.6</b> Software</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="workflow-2.html"><a href="workflow-2.html"><i class="fa fa-check"></i><b>10</b> Workflow</a><ul>
<li class="chapter" data-level="10.1" data-path="workflow-2.html"><a href="workflow-2.html#platform-for-metabolomics"><i class="fa fa-check"></i><b>10.1</b> Platform for metabolomics</a><ul>
<li class="chapter" data-level="10.1.1" data-path="workflow-2.html"><a href="workflow-2.html#xcms-online"><i class="fa fa-check"></i><b>10.1.1</b> XCMS online</a></li>
<li class="chapter" data-level="10.1.2" data-path="workflow-2.html"><a href="workflow-2.html#prime"><i class="fa fa-check"></i><b>10.1.2</b> PRIMe</a></li>
<li class="chapter" data-level="10.1.3" data-path="workflow-2.html"><a href="workflow-2.html#openms"><i class="fa fa-check"></i><b>10.1.3</b> OpenMS</a></li>
<li class="chapter" data-level="10.1.4" data-path="workflow-2.html"><a href="workflow-2.html#mzmine-2"><i class="fa fa-check"></i><b>10.1.4</b> MZmine 2</a></li>
<li class="chapter" data-level="10.1.5" data-path="workflow-2.html"><a href="workflow-2.html#xcms"><i class="fa fa-check"></i><b>10.1.5</b> XCMS</a></li>
<li class="chapter" data-level="10.1.6" data-path="workflow-2.html"><a href="workflow-2.html#emory-mahpic"><i class="fa fa-check"></i><b>10.1.6</b> Emory MaHPIC</a></li>
<li class="chapter" data-level="10.1.7" data-path="workflow-2.html"><a href="workflow-2.html#dia-data-analysis"><i class="fa fa-check"></i><b>10.1.7</b> DIA data analysis</a></li>
<li class="chapter" data-level="10.1.8" data-path="workflow-2.html"><a href="workflow-2.html#others"><i class="fa fa-check"></i><b>10.1.8</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="workflow-2.html"><a href="workflow-2.html#data-sharing"><i class="fa fa-check"></i><b>10.2</b> Data sharing</a></li>
<li class="chapter" data-level="10.3" data-path="workflow-2.html"><a href="workflow-2.html#contest"><i class="fa fa-check"></i><b>10.3</b> Contest</a></li>
<li class="chapter" data-level="10.4" data-path="workflow-2.html"><a href="workflow-2.html#demo"><i class="fa fa-check"></i><b>10.4</b> Demo</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="demo-1.html"><a href="demo-1.html"><i class="fa fa-check"></i><b>11</b> Demo</a><ul>
<li class="chapter" data-level="11.1" data-path="demo-1.html"><a href="demo-1.html#project-setup"><i class="fa fa-check"></i><b>11.1</b> Project Setup</a></li>
<li class="chapter" data-level="11.2" data-path="demo-1.html"><a href="demo-1.html#data-input"><i class="fa fa-check"></i><b>11.2</b> Data input</a></li>
<li class="chapter" data-level="11.3" data-path="demo-1.html"><a href="demo-1.html#optimization"><i class="fa fa-check"></i><b>11.3</b> Optimization</a></li>
<li class="chapter" data-level="11.4" data-path="demo-1.html"><a href="demo-1.html#wrap-function"><i class="fa fa-check"></i><b>11.4</b> Wrap function</a><ul>
<li class="chapter" data-level="11.4.1" data-path="demo-1.html"><a href="demo-1.html#peak-picking-1"><i class="fa fa-check"></i><b>11.4.1</b> Peak picking</a></li>
<li class="chapter" data-level="11.4.2" data-path="demo-1.html"><a href="demo-1.html#data-correction"><i class="fa fa-check"></i><b>11.4.2</b> Data correction</a></li>
<li class="chapter" data-level="11.4.3" data-path="demo-1.html"><a href="demo-1.html#peaks-filling"><i class="fa fa-check"></i><b>11.4.3</b> Peaks filling</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="demo-1.html"><a href="demo-1.html#peaks-list"><i class="fa fa-check"></i><b>11.5</b> Peaks list</a></li>
<li class="chapter" data-level="11.6" data-path="demo-1.html"><a href="demo-1.html#peaks-filtering"><i class="fa fa-check"></i><b>11.6</b> Peaks filtering</a></li>
<li class="chapter" data-level="11.7" data-path="demo-1.html"><a href="demo-1.html#normalization-optional"><i class="fa fa-check"></i><b>11.7</b> Normalization (Optional)</a></li>
<li class="chapter" data-level="11.8" data-path="demo-1.html"><a href="demo-1.html#statistic-analysis"><i class="fa fa-check"></i><b>11.8</b> Statistic analysis</a></li>
<li class="chapter" data-level="11.9" data-path="demo-1.html"><a href="demo-1.html#annotation-1"><i class="fa fa-check"></i><b>11.9</b> Annotation</a></li>
<li class="chapter" data-level="11.10" data-path="demo-1.html"><a href="demo-1.html#pathway-analysis-1"><i class="fa fa-check"></i><b>11.10</b> Pathway Analysis</a></li>
<li class="chapter" data-level="11.11" data-path="demo-1.html"><a href="demo-1.html#metaboanalyst"><i class="fa fa-check"></i><b>11.11</b> MetaboAnalyst</a></li>
<li class="chapter" data-level="11.12" data-path="demo-1.html"><a href="demo-1.html#summary"><i class="fa fa-check"></i><b>11.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="exposome.html"><a href="exposome.html"><i class="fa fa-check"></i><b>12</b> Exposome</a><ul>
<li class="chapter" data-level="12.1" data-path="exposome.html"><a href="exposome.html#internal-exposure"><i class="fa fa-check"></i><b>12.1</b> Internal exposure</a></li>
<li class="chapter" data-level="12.2" data-path="exposome.html"><a href="exposome.html#external-exposure"><i class="fa fa-check"></i><b>12.2</b> External exposure</a><ul>
<li class="chapter" data-level="12.2.1" data-path="exposome.html"><a href="exposome.html#environmental-fate-of-compounds"><i class="fa fa-check"></i><b>12.2.1</b> Environmental fate of compounds</a></li>
<li class="chapter" data-level="12.2.2" data-path="exposome.html"><a href="exposome.html#exposure-study-database"><i class="fa fa-check"></i><b>12.2.2</b> Exposure study database</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/yufree/metaworkflow" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Meta-Workflow</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="demo-1" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Demo</h1>
<div id="project-setup" class="section level2">
<h2><span class="header-section-number">11.1</span> Project Setup</h2>
<p>I suggest building your data analysis projects in RStudio(Click File - New project - New dictionary - Empty project). Then assign a name for your project. I also recommend the following tips if you are familiar with it.</p>
<ul>
<li><p>Use <a href="https://git-scm.com/">git</a>/<a href="https://github.com/">github</a> to make version control of your code and sync your project online.</p></li>
<li><p>Donâ€™t use your name for your project because other peoples might cooperate with you and someone might check your data when you publish your papers. Each project should be a work for one paper or one chapter in your thesis.</p></li>
<li><p>Use <strong>workflow</strong> document(txt or doc) in your project to record all of the steps and code you performed for this project. Treat this document as digital version of your experiment notebook</p></li>
<li><p>Use <strong>data</strong> folder in your project folder for the raw data and the results you get in data analysis</p></li>
<li><p>Use <strong>figure</strong> folder in your project folder for the figure</p></li>
<li><p>Use <strong>munuscript</strong> folder in your project folder for the manuscript (you could write paper in rstudio with the help of template in <a href="https://github.com/rstudio/rticles">Rmarkdown</a>)</p></li>
<li><p>Just double click <strong>[yourprojectname].Rproj</strong> to start your project</p></li>
</ul>
</div>
<div id="data-input" class="section level2">
<h2><span class="header-section-number">11.2</span> Data input</h2>
<p><strong>xcms</strong> does not support all of the raw files formate from every mass spectrometry. You need to convert your raw data into some open-source <a href="https://en.wikipedia.org/wiki/Mass_spectrometry_data_format">data format</a> such as mzData, mzXML or CDF files. The tool is <strong>MSconvert</strong> from <a href="http://proteowizard.sourceforge.net/"><strong>ProteoWizard</strong></a>.</p>
</div>
<div id="optimization" class="section level2">
<h2><span class="header-section-number">11.3</span> Optimization</h2>
<p>IPO package could be used to optimaze the parameters for XCMS. Try the following code and here we employ 5 NIST 1950 samples and 6 matrix blank samples as demodata from <code>rmwf</code> package.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="demo-1.html#cb24-1"></a><span class="kw">library</span>(IPO)</span>
<span id="cb24-2"><a href="demo-1.html#cb24-2"></a><span class="kw">library</span>(xcms)</span>
<span id="cb24-3"><a href="demo-1.html#cb24-3"></a><span class="kw">library</span>(rmwf)</span>
<span id="cb24-4"><a href="demo-1.html#cb24-4"></a>path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/data&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;rmwf&quot;</span>)</span>
<span id="cb24-5"><a href="demo-1.html#cb24-5"></a>files &lt;-<span class="st"> </span><span class="kw">list.files</span>(path,<span class="dt">recursive =</span> T,<span class="dt">full.names =</span> T)</span>
<span id="cb24-6"><a href="demo-1.html#cb24-6"></a></span>
<span id="cb24-7"><a href="demo-1.html#cb24-7"></a><span class="co"># BiocManager::install(&quot;IPO&quot;)</span></span>
<span id="cb24-8"><a href="demo-1.html#cb24-8"></a><span class="kw">library</span>(IPO)</span>
<span id="cb24-9"><a href="demo-1.html#cb24-9"></a><span class="kw">library</span>(xcms)</span>
<span id="cb24-10"><a href="demo-1.html#cb24-10"></a>peakpickingParameters &lt;-<span class="st"> </span><span class="kw">getDefaultXcmsSetStartingParams</span>(<span class="st">&#39;centWave&#39;</span>)</span>
<span id="cb24-11"><a href="demo-1.html#cb24-11"></a><span class="co"># Demo data</span></span>
<span id="cb24-12"><a href="demo-1.html#cb24-12"></a>path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/data&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;rmwf&quot;</span>)</span>
<span id="cb24-13"><a href="demo-1.html#cb24-13"></a>files &lt;-<span class="st"> </span><span class="kw">list.files</span>(path,<span class="dt">recursive =</span> T,<span class="dt">full.names =</span> T)</span>
<span id="cb24-14"><a href="demo-1.html#cb24-14"></a><span class="co"># Uncomment this line to use your own data(suggested 3-5 pooled QC samples)</span></span>
<span id="cb24-15"><a href="demo-1.html#cb24-15"></a><span class="co"># path &lt;- &#39;path/to/your/files&#39;</span></span>
<span id="cb24-16"><a href="demo-1.html#cb24-16"></a><span class="co"># change to 5 for obitrap</span></span>
<span id="cb24-17"><a href="demo-1.html#cb24-17"></a>peakpickingParameters<span class="op">$</span>ppm &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb24-18"><a href="demo-1.html#cb24-18"></a>resultPeakpicking &lt;-<span class="st"> </span></span>
<span id="cb24-19"><a href="demo-1.html#cb24-19"></a><span class="st">  </span><span class="kw">optimizeXcmsSet</span>(<span class="dt">files =</span> files[<span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>)], </span>
<span id="cb24-20"><a href="demo-1.html#cb24-20"></a>                  <span class="dt">params =</span> peakpickingParameters,</span>
<span id="cb24-21"><a href="demo-1.html#cb24-21"></a>                  <span class="dt">plot =</span> F,</span>
<span id="cb24-22"><a href="demo-1.html#cb24-22"></a>                  <span class="dt">subdir =</span> <span class="ot">NULL</span>)</span>
<span id="cb24-23"><a href="demo-1.html#cb24-23"></a></span>
<span id="cb24-24"><a href="demo-1.html#cb24-24"></a>optimizedXcmsSetObject &lt;-<span class="st"> </span>resultPeakpicking<span class="op">$</span>best_settings<span class="op">$</span>xset</span>
<span id="cb24-25"><a href="demo-1.html#cb24-25"></a>retcorGroupParameters &lt;-<span class="st"> </span><span class="kw">getDefaultRetGroupStartingParams</span>()</span>
<span id="cb24-26"><a href="demo-1.html#cb24-26"></a>resultRetcorGroup &lt;-</span>
<span id="cb24-27"><a href="demo-1.html#cb24-27"></a><span class="st">  </span><span class="kw">optimizeRetGroup</span>(<span class="dt">xset =</span> optimizedXcmsSetObject, </span>
<span id="cb24-28"><a href="demo-1.html#cb24-28"></a>                   <span class="dt">params =</span> retcorGroupParameters, </span>
<span id="cb24-29"><a href="demo-1.html#cb24-29"></a>                   <span class="dt">plot =</span> F,</span>
<span id="cb24-30"><a href="demo-1.html#cb24-30"></a>                   <span class="dt">subdir =</span> <span class="ot">NULL</span>)</span>
<span id="cb24-31"><a href="demo-1.html#cb24-31"></a>para &lt;-<span class="st"> </span><span class="kw">c</span>(resultPeakpicking<span class="op">$</span>best_settings<span class="op">$</span>parameters, </span>
<span id="cb24-32"><a href="demo-1.html#cb24-32"></a>          resultRetcorGroup<span class="op">$</span>best_settings)</span>
<span id="cb24-33"><a href="demo-1.html#cb24-33"></a><span class="kw">save</span>(para,<span class="dt">file =</span> <span class="st">&#39;para.RData&#39;</span>)</span>
<span id="cb24-34"><a href="demo-1.html#cb24-34"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
</div>
<div id="wrap-function" class="section level2">
<h2><span class="header-section-number">11.4</span> Wrap function</h2>
<p>Here we would use the optimized parameters for peak picking, retention time correction and peaks filling.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="demo-1.html#cb25-1"></a><span class="kw">load</span>(<span class="st">&#39;para.RData&#39;</span>)</span>
<span id="cb25-2"><a href="demo-1.html#cb25-2"></a><span class="kw">library</span>(xcms)</span>
<span id="cb25-3"><a href="demo-1.html#cb25-3"></a><span class="kw">library</span>(stringr)</span>
<span id="cb25-4"><a href="demo-1.html#cb25-4"></a>getrtmz &lt;-<span class="st"> </span><span class="cf">function</span>(path,<span class="dt">index =</span> <span class="ot">NULL</span>){</span>
<span id="cb25-5"><a href="demo-1.html#cb25-5"></a>  peakwidth &lt;-<span class="st"> </span><span class="kw">c</span>(para<span class="op">$</span>min_peakwidth,para<span class="op">$</span>max_peakwidth)</span>
<span id="cb25-6"><a href="demo-1.html#cb25-6"></a>  ppm &lt;-<span class="st"> </span>para<span class="op">$</span>ppm</span>
<span id="cb25-7"><a href="demo-1.html#cb25-7"></a>  noise &lt;-<span class="st"> </span>para<span class="op">$</span>noise</span>
<span id="cb25-8"><a href="demo-1.html#cb25-8"></a>  snthresh &lt;-<span class="st"> </span>para<span class="op">$</span>snthresh</span>
<span id="cb25-9"><a href="demo-1.html#cb25-9"></a>  mzdiff &lt;-<span class="st"> </span>para<span class="op">$</span>mzdiff</span>
<span id="cb25-10"><a href="demo-1.html#cb25-10"></a>  prefilter &lt;-<span class="st"> </span><span class="kw">c</span>(para<span class="op">$</span>prefilter,para<span class="op">$</span>value_of_prefilter)</span>
<span id="cb25-11"><a href="demo-1.html#cb25-11"></a>  integrate &lt;-<span class="st"> </span>para<span class="op">$</span>integrate</span>
<span id="cb25-12"><a href="demo-1.html#cb25-12"></a>  profStep &lt;-<span class="st"> </span>para<span class="op">$</span>profStep</span>
<span id="cb25-13"><a href="demo-1.html#cb25-13"></a>  center &lt;-<span class="st"> </span>para<span class="op">$</span>center</span>
<span id="cb25-14"><a href="demo-1.html#cb25-14"></a>  response &lt;-<span class="st"> </span>para<span class="op">$</span>response</span>
<span id="cb25-15"><a href="demo-1.html#cb25-15"></a>  gapInit &lt;-<span class="st"> </span>para<span class="op">$</span>gapInit</span>
<span id="cb25-16"><a href="demo-1.html#cb25-16"></a>  gapExtend &lt;-<span class="st"> </span>para<span class="op">$</span>gapExtend</span>
<span id="cb25-17"><a href="demo-1.html#cb25-17"></a>  factorDiag &lt;-<span class="st"> </span>para<span class="op">$</span>factorDiag</span>
<span id="cb25-18"><a href="demo-1.html#cb25-18"></a>  factorGap &lt;-<span class="st"> </span>para<span class="op">$</span>factorGap</span>
<span id="cb25-19"><a href="demo-1.html#cb25-19"></a>  localAlignment &lt;-<span class="st"> </span>para<span class="op">$</span>localAlignment</span>
<span id="cb25-20"><a href="demo-1.html#cb25-20"></a>  bw &lt;-<span class="st"> </span>para<span class="op">$</span>bw</span>
<span id="cb25-21"><a href="demo-1.html#cb25-21"></a>  mzwid &lt;-<span class="st"> </span>para<span class="op">$</span>mzwid</span>
<span id="cb25-22"><a href="demo-1.html#cb25-22"></a>  minfrac &lt;-<span class="st"> </span>para<span class="op">$</span>minfrac</span>
<span id="cb25-23"><a href="demo-1.html#cb25-23"></a>  minsamp &lt;-<span class="st"> </span>para<span class="op">$</span>minsamp</span>
<span id="cb25-24"><a href="demo-1.html#cb25-24"></a>  max &lt;-<span class="st"> </span>para<span class="op">$</span>max</span>
<span id="cb25-25"><a href="demo-1.html#cb25-25"></a>  distFunc &lt;-<span class="st"> </span>para<span class="op">$</span>distFunc</span>
<span id="cb25-26"><a href="demo-1.html#cb25-26"></a>  plottype &lt;-<span class="st"> </span>para<span class="op">$</span>plottype</span>
<span id="cb25-27"><a href="demo-1.html#cb25-27"></a>  retcorMethod &lt;-<span class="st"> </span>para<span class="op">$</span>retcorMethod</span>
<span id="cb25-28"><a href="demo-1.html#cb25-28"></a>  mzCenterFun &lt;-<span class="st"> </span>para<span class="op">$</span>mzCenterFun</span>
<span id="cb25-29"><a href="demo-1.html#cb25-29"></a>  fitgauss &lt;-<span class="st"> </span>para<span class="op">$</span>fitgauss</span>
<span id="cb25-30"><a href="demo-1.html#cb25-30"></a>  verboseColumns &lt;-<span class="st"> </span>para<span class="op">$</span>verbose.columns</span>
<span id="cb25-31"><a href="demo-1.html#cb25-31"></a>  files &lt;-<span class="st"> </span><span class="kw">list.files</span>(path,<span class="dt">full.names =</span> T,<span class="dt">recursive =</span> T)</span>
<span id="cb25-32"><a href="demo-1.html#cb25-32"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.null</span>(index)){</span>
<span id="cb25-33"><a href="demo-1.html#cb25-33"></a>    files &lt;-<span class="st"> </span>files[index]</span>
<span id="cb25-34"><a href="demo-1.html#cb25-34"></a>  }</span>
<span id="cb25-35"><a href="demo-1.html#cb25-35"></a>  xset &lt;-<span class="st"> </span><span class="kw">xcmsSet</span>(files,</span>
<span id="cb25-36"><a href="demo-1.html#cb25-36"></a>                  <span class="dt">method =</span> <span class="st">&quot;centWave&quot;</span>,</span>
<span id="cb25-37"><a href="demo-1.html#cb25-37"></a>                  <span class="dt">peakwidth       =</span> peakwidth,</span>
<span id="cb25-38"><a href="demo-1.html#cb25-38"></a>                  <span class="dt">ppm             =</span> ppm,</span>
<span id="cb25-39"><a href="demo-1.html#cb25-39"></a>                  <span class="dt">noise           =</span> noise,</span>
<span id="cb25-40"><a href="demo-1.html#cb25-40"></a>                  <span class="dt">snthresh        =</span> snthresh,</span>
<span id="cb25-41"><a href="demo-1.html#cb25-41"></a>                  <span class="dt">mzdiff          =</span> mzdiff,</span>
<span id="cb25-42"><a href="demo-1.html#cb25-42"></a>                  <span class="dt">prefilter       =</span> prefilter,</span>
<span id="cb25-43"><a href="demo-1.html#cb25-43"></a>                  <span class="dt">mzCenterFun     =</span> mzCenterFun,</span>
<span id="cb25-44"><a href="demo-1.html#cb25-44"></a>                  <span class="dt">integrate       =</span> integrate,</span>
<span id="cb25-45"><a href="demo-1.html#cb25-45"></a>                  <span class="dt">fitgauss        =</span> fitgauss,</span>
<span id="cb25-46"><a href="demo-1.html#cb25-46"></a>                  <span class="dt">verbose.columns =</span> verboseColumns)</span>
<span id="cb25-47"><a href="demo-1.html#cb25-47"></a>  xset &lt;-<span class="st"> </span><span class="kw">retcor</span>( </span>
<span id="cb25-48"><a href="demo-1.html#cb25-48"></a>    xset,</span>
<span id="cb25-49"><a href="demo-1.html#cb25-49"></a>    <span class="dt">method         =</span> retcorMethod,</span>
<span id="cb25-50"><a href="demo-1.html#cb25-50"></a>    <span class="dt">plottype       =</span> plottype,</span>
<span id="cb25-51"><a href="demo-1.html#cb25-51"></a>    <span class="dt">distFunc       =</span> distFunc,</span>
<span id="cb25-52"><a href="demo-1.html#cb25-52"></a>    <span class="dt">profStep       =</span> profStep,</span>
<span id="cb25-53"><a href="demo-1.html#cb25-53"></a>    <span class="dt">center         =</span> center,</span>
<span id="cb25-54"><a href="demo-1.html#cb25-54"></a>    <span class="dt">response       =</span> response,</span>
<span id="cb25-55"><a href="demo-1.html#cb25-55"></a>    <span class="dt">gapInit        =</span> gapInit,</span>
<span id="cb25-56"><a href="demo-1.html#cb25-56"></a>    <span class="dt">gapExtend      =</span> gapExtend,</span>
<span id="cb25-57"><a href="demo-1.html#cb25-57"></a>    <span class="dt">factorDiag     =</span> factorDiag,</span>
<span id="cb25-58"><a href="demo-1.html#cb25-58"></a>    <span class="dt">factorGap      =</span> factorGap,</span>
<span id="cb25-59"><a href="demo-1.html#cb25-59"></a>    <span class="dt">localAlignment =</span> localAlignment)</span>
<span id="cb25-60"><a href="demo-1.html#cb25-60"></a>  xset &lt;-<span class="st"> </span><span class="kw">group</span>( </span>
<span id="cb25-61"><a href="demo-1.html#cb25-61"></a>    xset,</span>
<span id="cb25-62"><a href="demo-1.html#cb25-62"></a>    <span class="dt">method  =</span> <span class="st">&quot;density&quot;</span>,</span>
<span id="cb25-63"><a href="demo-1.html#cb25-63"></a>    <span class="dt">bw      =</span> bw,</span>
<span id="cb25-64"><a href="demo-1.html#cb25-64"></a>    <span class="dt">mzwid   =</span> mzwid,</span>
<span id="cb25-65"><a href="demo-1.html#cb25-65"></a>    <span class="dt">minfrac =</span> minfrac,</span>
<span id="cb25-66"><a href="demo-1.html#cb25-66"></a>    <span class="dt">minsamp =</span> minsamp,</span>
<span id="cb25-67"><a href="demo-1.html#cb25-67"></a>    <span class="dt">max     =</span> max)</span>
<span id="cb25-68"><a href="demo-1.html#cb25-68"></a>  </span>
<span id="cb25-69"><a href="demo-1.html#cb25-69"></a>  xset &lt;-<span class="st"> </span><span class="kw">fillPeaks</span>(xset)</span>
<span id="cb25-70"><a href="demo-1.html#cb25-70"></a>  <span class="kw">return</span>(xset)</span>
<span id="cb25-71"><a href="demo-1.html#cb25-71"></a>}</span></code></pre></div>
<div id="peak-picking-1" class="section level3">
<h3><span class="header-section-number">11.4.1</span> Peak picking</h3>
<p>The first step to process the MS data is that find the peaks against the noises. In <strong>xcms</strong>, all of related staffs are handled by <em>xcmsSet</em> function.</p>
<p>For any functions in <strong>xcms</strong> or <strong>R</strong>, you could get their documents by type <code>?</code> before certain function. Another geek way is input the name of the function in the console of Rstudio and press F1 for help.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="demo-1.html#cb26-1"></a>?xcmsSet</span></code></pre></div>
<p>In the document of <em>xcmsset</em>, we could set the sample classes, profmethod, profparam, polarity,etc. In the online version, such configurations are shown in certain windows. In the local analysis environment, such parameters are setup by yourselves. However, I think the default configurations could satisfied most of the analysis because related information should have been recorded in your Raw data and <strong>xcms</strong> could find them. All you need to do is that show the data dictionary for <em>xcmsSet</em>.</p>
<p>If your data have many groups such as control and treated group, just put them in separate subfolder of the data folder and <em>xcmsSet</em> would read them as separated groups.</p>
</div>
<div id="data-correction" class="section level3">
<h3><span class="header-section-number">11.4.2</span> Data correction</h3>
<p>Reasons of data correction might come from many aspects such as the unstable instrument and pollution on column. In <strong>xcms</strong>, the most important correction is retention time correction. Remember the original retention time might changed and use another object to save the new object.</p>
</div>
<div id="peaks-filling" class="section level3">
<h3><span class="header-section-number">11.4.3</span> Peaks filling</h3>
<p>After the retention time correction, filling the missing peaks could be done by <em>fillpeaks</em>. Peaks filling could avoid two many NAs for false statistical analysis. The algorithm could use the baseline signal to impute the data.</p>
</div>
</div>
<div id="peaks-list" class="section level2">
<h2><span class="header-section-number">11.5</span> Peaks list</h2>
<p>Then we could extract the peaks list from <code>xcmsSet</code> objects.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="demo-1.html#cb27-1"></a><span class="kw">library</span>(enviGCMS)</span>
<span id="cb27-2"><a href="demo-1.html#cb27-2"></a><span class="co"># get the xcmsset object</span></span>
<span id="cb27-3"><a href="demo-1.html#cb27-3"></a>path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/data&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;rmwf&quot;</span>)</span>
<span id="cb27-4"><a href="demo-1.html#cb27-4"></a><span class="co"># use your own data</span></span>
<span id="cb27-5"><a href="demo-1.html#cb27-5"></a><span class="co"># path &lt;- &#39;path/to/your/file&#39;</span></span>
<span id="cb27-6"><a href="demo-1.html#cb27-6"></a>srm &lt;-<span class="st"> </span><span class="kw">getrtmz</span>(path)</span>
<span id="cb27-7"><a href="demo-1.html#cb27-7"></a><span class="co"># back up the xcmsset object, xcmsEIC object and peak list</span></span>
<span id="cb27-8"><a href="demo-1.html#cb27-8"></a>mzrt &lt;-<span class="st"> </span>enviGCMS<span class="op">::</span><span class="kw">getmzrt</span>(srm, <span class="dt">name =</span> <span class="st">&#39;srm&#39;</span>, <span class="dt">eic =</span> T, <span class="dt">type =</span> <span class="st">&#39;mapo&#39;</span>)</span></code></pre></div>
</div>
<div id="peaks-filtering" class="section level2">
<h2><span class="header-section-number">11.6</span> Peaks filtering</h2>
<p>After we get the peaks list, itâ€™s nessary to filter the peaks list to retain the peaks with high quality for further analysis. Normally, we could use the relative standard deviation of blank and pooled QC samples to control the peaks list.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="demo-1.html#cb28-1"></a><span class="kw">load</span>(<span class="st">&#39;srmmzrt.RDS&#39;</span>)</span>
<span id="cb28-2"><a href="demo-1.html#cb28-2"></a><span class="co"># get the peak intensity, m/z, retention time and group information as list</span></span>
<span id="cb28-3"><a href="demo-1.html#cb28-3"></a>mzrt &lt;-<span class="st"> </span>enviGCMS<span class="op">::</span><span class="kw">getmzrt</span>(srm)</span>
<span id="cb28-4"><a href="demo-1.html#cb28-4"></a><span class="kw">data</span>(mzrt)</span>
<span id="cb28-5"><a href="demo-1.html#cb28-5"></a><span class="co"># get the mean and rsd for each group</span></span>
<span id="cb28-6"><a href="demo-1.html#cb28-6"></a>mzrtm &lt;-<span class="st"> </span>enviGCMS<span class="op">::</span><span class="kw">getdoe</span>(mzrt)</span>
<span id="cb28-7"><a href="demo-1.html#cb28-7"></a>gm &lt;-<span class="st"> </span>mzrtm<span class="op">$</span>groupmean</span>
<span id="cb28-8"><a href="demo-1.html#cb28-8"></a>gr &lt;-<span class="st"> </span>mzrtm<span class="op">$</span>grouprsd</span>
<span id="cb28-9"><a href="demo-1.html#cb28-9"></a><span class="co"># find the blank group and pool QC group, demo data only have matrix blank</span></span>
<span id="cb28-10"><a href="demo-1.html#cb28-10"></a>srm &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&#39;NIST&#39;</span>,<span class="kw">colnames</span>(gm))</span>
<span id="cb28-11"><a href="demo-1.html#cb28-11"></a>blk &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&#39;Matrix&#39;</span>,<span class="kw">colnames</span>(gm))</span>
<span id="cb28-12"><a href="demo-1.html#cb28-12"></a><span class="co"># pqc &lt;- grepl(&#39;pool&#39;,colnames(gm))</span></span>
<span id="cb28-13"><a href="demo-1.html#cb28-13"></a><span class="co"># filter by pool QC and blank&#39;s group mean intensity(pool QC should larger than three times of blank), return numbers and index</span></span>
<span id="cb28-14"><a href="demo-1.html#cb28-14"></a><span class="co"># in demo data, use sample average intensity for each peak</span></span>
<span id="cb28-15"><a href="demo-1.html#cb28-15"></a><span class="kw">sum</span>(indexmean &lt;-<span class="st"> </span><span class="kw">apply</span>(gm,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="kw">all</span>(x[srm]<span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x[blk])))</span>
<span id="cb28-16"><a href="demo-1.html#cb28-16"></a><span class="co"># filter by pool qc rsd%, return numbers and index</span></span>
<span id="cb28-17"><a href="demo-1.html#cb28-17"></a><span class="co"># in demo data, use sample average intensity for each peak</span></span>
<span id="cb28-18"><a href="demo-1.html#cb28-18"></a><span class="co"># mean rsd analysis</span></span>
<span id="cb28-19"><a href="demo-1.html#cb28-19"></a><span class="co"># filter by pool qc rsd%, return numbers and index, here we use SRM samples</span></span>
<span id="cb28-20"><a href="demo-1.html#cb28-20"></a>rsdcf &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb28-21"><a href="demo-1.html#cb28-21"></a><span class="kw">sum</span>(indexrsd &lt;-<span class="st"> </span><span class="kw">apply</span>(gr,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="kw">ifelse</span>(<span class="kw">is.na</span>(x[srm]),T,x[srm]<span class="op">&lt;</span>rsdcf)))</span>
<span id="cb28-22"><a href="demo-1.html#cb28-22"></a><span class="co"># overlap with rsd% and mean filter</span></span>
<span id="cb28-23"><a href="demo-1.html#cb28-23"></a><span class="kw">sum</span>(index &lt;-<span class="st"> </span>indexmean<span class="op">&amp;</span>indexrsd)</span>
<span id="cb28-24"><a href="demo-1.html#cb28-24"></a><span class="co"># new list, update group and remove pool qc/blk</span></span>
<span id="cb28-25"><a href="demo-1.html#cb28-25"></a><span class="co"># qcindex &lt;- grepl(&#39;k&#39;,mzrt$group$class) | grepl(&#39;q&#39;,mzrt$group$class)</span></span>
<span id="cb28-26"><a href="demo-1.html#cb28-26"></a><span class="co"># mzrtfilter &lt;- mzrtfilter &lt;- enviGCMS::getfilter(mzrt,rowindex = index,colindex = !qcindex, name = &#39;lif&#39;, type = &#39;m&#39;)</span></span>
<span id="cb28-27"><a href="demo-1.html#cb28-27"></a>mzrtfilter &lt;-<span class="st"> </span>mzrtfilter &lt;-<span class="st"> </span>enviGCMS<span class="op">::</span><span class="kw">getfilter</span>(mzrt,<span class="dt">rowindex =</span> index, <span class="dt">name =</span> <span class="st">&#39;lif&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;m&#39;</span>)</span></code></pre></div>
</div>
<div id="normalization-optional" class="section level2">
<h2><span class="header-section-number">11.7</span> Normalization (Optional)</h2>
<p>Normailizaiton is nesscery if you data are collected at different batch or runned in differen instrument parameters.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="demo-1.html#cb29-1"></a><span class="co"># visulize the batch effect</span></span>
<span id="cb29-2"><a href="demo-1.html#cb29-2"></a>mzrtsim<span class="op">::</span><span class="kw">rlaplot</span>(mzrt<span class="op">$</span>data,<span class="dt">lv =</span> mzrt<span class="op">$</span>group<span class="op">$</span>class)</span>
<span id="cb29-3"><a href="demo-1.html#cb29-3"></a>mzrtsim<span class="op">::</span><span class="kw">ridgesplot</span>(mzrt<span class="op">$</span>data,<span class="dt">lv =</span> mzrt<span class="op">$</span>group<span class="op">$</span>class)</span>
<span id="cb29-4"><a href="demo-1.html#cb29-4"></a><span class="co"># get the simulation data and test on NOREVA</span></span>
<span id="cb29-5"><a href="demo-1.html#cb29-5"></a>sim &lt;-<span class="st"> </span>mzrtsim<span class="op">::</span><span class="kw">simmzrt</span>(mzrt<span class="op">$</span>data)</span>
<span id="cb29-6"><a href="demo-1.html#cb29-6"></a>mzrtsim<span class="op">::</span><span class="kw">simdata</span>(sim)</span>
<span id="cb29-7"><a href="demo-1.html#cb29-7"></a><span class="co"># correct the batch effect by sva</span></span>
<span id="cb29-8"><a href="demo-1.html#cb29-8"></a>mzrtcor &lt;-<span class="st"> </span>mzrtsim<span class="op">::</span><span class="kw">svacor</span>(mzrt<span class="op">$</span>data,<span class="dt">lv =</span> mzrt<span class="op">$</span>group<span class="op">$</span>class)</span>
<span id="cb29-9"><a href="demo-1.html#cb29-9"></a><span class="co"># visulize the batch effect correction</span></span>
<span id="cb29-10"><a href="demo-1.html#cb29-10"></a>li &lt;-<span class="st"> </span>mzrtsim<span class="op">::</span><span class="kw">limmaplot</span>(mzrtcor,<span class="dt">lv =</span> mzrt<span class="op">$</span>group<span class="op">$</span>class)</span>
<span id="cb29-11"><a href="demo-1.html#cb29-11"></a><span class="co"># return the corrected data</span></span>
<span id="cb29-12"><a href="demo-1.html#cb29-12"></a>mzrt<span class="op">$</span>data &lt;-<span class="st"> </span>mzrtcor<span class="op">$</span>dataCorrected</span></code></pre></div>
</div>
<div id="statistic-analysis" class="section level2">
<h2><span class="header-section-number">11.8</span> Statistic analysis</h2>
<p>Here we could use <code>caret</code> package to perform statistical analysis.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="demo-1.html#cb30-1"></a><span class="kw">library</span>(caret)</span>
<span id="cb30-2"><a href="demo-1.html#cb30-2"></a><span class="co">## Spliting data</span></span>
<span id="cb30-3"><a href="demo-1.html#cb30-3"></a>trainIndex &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(mzrtfilter<span class="op">$</span>data, <span class="dt">p =</span> <span class="fl">.8</span>, </span>
<span id="cb30-4"><a href="demo-1.html#cb30-4"></a>                                  <span class="dt">list =</span> <span class="ot">FALSE</span>, </span>
<span id="cb30-5"><a href="demo-1.html#cb30-5"></a>                                  <span class="dt">times =</span> <span class="dv">1</span>)</span>
<span id="cb30-6"><a href="demo-1.html#cb30-6"></a><span class="co">## Get the training and testing datasets</span></span>
<span id="cb30-7"><a href="demo-1.html#cb30-7"></a>Train &lt;-<span class="st"> </span>data[ trainIndex,]</span>
<span id="cb30-8"><a href="demo-1.html#cb30-8"></a>Test  &lt;-<span class="st"> </span>data[<span class="op">-</span>trainIndex,]</span>
<span id="cb30-9"><a href="demo-1.html#cb30-9"></a><span class="co">## Set the cross validation method</span></span>
<span id="cb30-10"><a href="demo-1.html#cb30-10"></a>fitControl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="co">## 10-fold CV</span></span>
<span id="cb30-11"><a href="demo-1.html#cb30-11"></a>                           <span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>,</span>
<span id="cb30-12"><a href="demo-1.html#cb30-12"></a>                           <span class="dt">number =</span> <span class="dv">10</span>,</span>
<span id="cb30-13"><a href="demo-1.html#cb30-13"></a>                           <span class="co">## repeated ten times</span></span>
<span id="cb30-14"><a href="demo-1.html#cb30-14"></a>                           <span class="dt">repeats =</span> <span class="dv">10</span>)</span>
<span id="cb30-15"><a href="demo-1.html#cb30-15"></a><span class="co"># extra papameters for GBM </span></span>
<span id="cb30-16"><a href="demo-1.html#cb30-16"></a>gbmGrid &lt;-<span class="st">  </span><span class="kw">expand.grid</span>(<span class="dt">interaction.depth =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>), </span>
<span id="cb30-17"><a href="demo-1.html#cb30-17"></a>                        <span class="dt">n.trees =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>)<span class="op">*</span><span class="dv">50</span>, </span>
<span id="cb30-18"><a href="demo-1.html#cb30-18"></a>                        <span class="dt">shrinkage =</span> <span class="fl">0.1</span>,</span>
<span id="cb30-19"><a href="demo-1.html#cb30-19"></a>                        <span class="dt">n.minobsinnode =</span> <span class="dv">20</span>)</span>
<span id="cb30-20"><a href="demo-1.html#cb30-20"></a></span>
<span id="cb30-21"><a href="demo-1.html#cb30-21"></a><span class="kw">set.seed</span>(<span class="dv">825</span>)</span>
<span id="cb30-22"><a href="demo-1.html#cb30-22"></a>gbmFit &lt;-<span class="st"> </span><span class="kw">train</span>(mzrtfilter<span class="op">$</span>group <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> training, </span>
<span id="cb30-23"><a href="demo-1.html#cb30-23"></a>                 <span class="dt">method =</span> <span class="st">&quot;gbm&quot;</span>, </span>
<span id="cb30-24"><a href="demo-1.html#cb30-24"></a>                 <span class="dt">trControl =</span> fitControl, </span>
<span id="cb30-25"><a href="demo-1.html#cb30-25"></a>                 <span class="dt">verbose =</span> <span class="ot">FALSE</span>, </span>
<span id="cb30-26"><a href="demo-1.html#cb30-26"></a>                 <span class="co">## Now specify the exact models </span></span>
<span id="cb30-27"><a href="demo-1.html#cb30-27"></a>                 <span class="co">## to evaluate:</span></span>
<span id="cb30-28"><a href="demo-1.html#cb30-28"></a>                 <span class="dt">tuneGrid =</span> gbmGrid)</span>
<span id="cb30-29"><a href="demo-1.html#cb30-29"></a><span class="co"># show the fitting process</span></span>
<span id="cb30-30"><a href="demo-1.html#cb30-30"></a><span class="kw">plot</span>(gbmFit)  </span>
<span id="cb30-31"><a href="demo-1.html#cb30-31"></a><span class="co"># ANOVA analysis for model selection</span></span>
<span id="cb30-32"><a href="demo-1.html#cb30-32"></a><span class="kw">anova</span>(fit1,fit2)</span>
<span id="cb30-33"><a href="demo-1.html#cb30-33"></a><span class="co"># find the important variables</span></span>
<span id="cb30-34"><a href="demo-1.html#cb30-34"></a>Imp &lt;-<span class="st"> </span><span class="kw">varImp</span>(fit)</span>
<span id="cb30-35"><a href="demo-1.html#cb30-35"></a><span class="kw">plot</span>(Imp)</span></code></pre></div>
</div>
<div id="annotation-1" class="section level2">
<h2><span class="header-section-number">11.9</span> Annotation</h2>
<p>Here I use <code>xMSannotator</code> package to make annotation with HMDB as reference database.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="demo-1.html#cb31-1"></a><span class="kw">library</span>(xMSannotator)</span>
<span id="cb31-2"><a href="demo-1.html#cb31-2"></a>num_nodes =<span class="st"> </span><span class="dv">10</span></span>
<span id="cb31-3"><a href="demo-1.html#cb31-3"></a><span class="kw">data</span>(<span class="st">&quot;adduct_weights&quot;</span>)</span>
<span id="cb31-4"><a href="demo-1.html#cb31-4"></a>negsub &lt;-<span class="st"> </span><span class="kw">getrtmz</span>(<span class="st">&#39;D:/metademo/data/oq/&#39;</span>)</span>
<span id="cb31-5"><a href="demo-1.html#cb31-5"></a>anno &lt;-<span class="st"> </span>xsetplus<span class="op">::</span><span class="kw">fanno</span>(negsub,<span class="dt">outloc =</span> <span class="st">&#39;D:/metademo/anno&#39;</span>,<span class="dt">mode =</span> <span class="st">&#39;neg&#39;</span>)</span></code></pre></div>
</div>
<div id="pathway-analysis-1" class="section level2">
<h2><span class="header-section-number">11.10</span> Pathway Analysis</h2>
<p>We could output the files for online pathway analysis with mummichog algorithm.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="demo-1.html#cb32-1"></a><span class="co"># get the file</span></span>
<span id="cb32-2"><a href="demo-1.html#cb32-2"></a>xsetplus<span class="op">::</span><span class="kw">mumdata</span>(neg,<span class="dt">lv =</span> mzrt<span class="op">$</span>group<span class="op">$</span>class)</span>
<span id="cb32-3"><a href="demo-1.html#cb32-3"></a><span class="co"># http://mummichog.org/index.html</span></span>
<span id="cb32-4"><a href="demo-1.html#cb32-4"></a><span class="co"># mummichog1 -f &#39;test.txt&#39; -o myResult</span></span></code></pre></div>
</div>
<div id="metaboanalyst" class="section level2">
<h2><span class="header-section-number">11.11</span> MetaboAnalyst</h2>
<p>Actully, after you perform data correction, you have got the data matrix for statistic analysis. You might choose <a href="http://www.metaboanalyst.ca/MetaboAnalyst/faces/docs/Contact.xhtml"><strong>MetaboAnalyst</strong></a> online or offline to make furthor analysis, which supplied more statistical choices than xcms.</p>
<p>The input data format for <strong>MetaboAnalyst</strong> should be rows for peaks and colomns for samples. You could also add groups infomation if possible. Use the following code to get the data for analysis.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="demo-1.html#cb33-1"></a><span class="co"># get the csv file for Metaboanalyst.ca</span></span>
<span id="cb33-2"><a href="demo-1.html#cb33-2"></a>enviGCMS<span class="op">::</span><span class="kw">getupload</span>(neg,<span class="dt">name =</span> <span class="st">&#39;metabo&#39;</span>)</span></code></pre></div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">11.12</span> Summary</h2>
<p>This is the offline metaboliomics data process workflow. For each study, details would be different and F1 is always your best friend.</p>
<p>Enjoy yourself in data mining!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="workflow-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exposome.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yufree/metaworkflow/edit/master/10-workflow.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Metabolomics.pdf", "Metabolomics.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
